description: >
  Download gmsaas cli and authenticate the user.
parameters:
  email:
    type: env_var_name
    default: GMCLOUD_SAAS_EMAIL
    description: "Email of your Genymotion Cloud SaaS account"
  password:
    type: env_var_name
    default: GMCLOUD_SAAS_PASSWORD
    description: "Password of your Genymotion Cloud SaaS account"
steps:
  - run:
      name: Install gmsaas cli
      command: |
        # Update distrib and install pip3
        sudo apt update
        sudo apt-get install python3-pip

        # Install Genymotion Cloud SaaS cli
        sudo pip3 install gmsaas
  - run:
      name: Configure gmsaas
      command: |
        export GMSAAS_USER_AGENT_EXTRA_DATA=circleci
        gmsaas config set android-sdk-path $ANDROID_HOME
  - run:
      name: Authenticate
      command: gmsaas auth login ${<< parameters.email >>} ${<< parameters.password >>}
